<!DOCTYPE html>
<html lang="es" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="guests:title">Zona de invitados - Boda de Iluminada & George</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/i18n-selector.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="js/i18n-common.js"></script>
  <style>
    /* Layout específico para la página de invitados */
    body {
      overflow-x: auto;
    }
    
    /* Forzar layout horizontal */
    .main-layout > * {
      display: block !important;
    }
    

    
    /* Sobrescribir estilos del CSS externo para main */
    main.main-layout {
      max-width: none !important;
      margin: 40px auto 0 !important;
      padding: 0 !important;
      background: transparent !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      margin-top: 40px !important;
      position: relative !important;
      z-index: 1 !important;
    }
    
    .menu-button-container {
      text-align: center;
      margin: 30px 0;
    }
    
    .menu-access-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 1.2em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .menu-access-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
    }
    
    .menu-access-btn i {
      margin-right: 10px;
    }
    
    .menu-status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background: #f8f9fa;
      border-left: 4px solid var(--primary-color);
    }
    
    .menu-status h4 {
      margin: 0 0 10px 0;
      color: var(--primary-color);
      font-size: 1.1em;
    }
    
    .menu-status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      padding: 5px 0;
    }
    
    .menu-status-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .menu-status-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    .no-selection {
      color: #6c757d;
      font-style: italic;
    }
    
    .agenda-button-container {
      text-align: center;
      margin: 30px 0;
    }
    
    .agenda-access-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 1.2em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .agenda-access-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
    }
    
    .agenda-access-btn i {
      margin-right: 10px;
    }
    
    .agenda-status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background: #f8f9fa;
      border-left: 4px solid var(--primary-color);
    }
    
    .agenda-status h4 {
      margin: 0 0 10px 0;
      color: var(--primary-color);
      font-size: 1.1em;
    }
    
    .agenda-status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      padding: 5px 0;
    }
    
    .agenda-status-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .agenda-status-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    .status-badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8em;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .status-confirmado {
      background: #d4edda;
      color: #155724;
    }
    
    .status-no-confirmado {
      background: #f8d7da;
      color: #721c24;
    }
    
    .regalos-button-container {
      text-align: center;
      margin: 20px 0;
    }
    
    .regalos-access-btn {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .regalos-access-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }
    
    /* Estilos para el aviso de bloqueo de agenda */
    .agenda-bloqueada-warning {
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
      border-left: 4px solid #d63031;
    }
    
    .warning-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    
    .warning-content i {
      font-size: 2em;
      margin-bottom: 10px;
    }
    
    .warning-content h3 {
      margin: 0 0 10px 0;
      font-size: 1.3em;
    }
    
    .warning-content p {
      margin: 5px 0;
      font-size: 0.95em;
      line-height: 1.4;
    }
    
    .btn-disabled {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      font-size: 0.8em;
      font-weight: 600;
      cursor: not-allowed;
      background: #6c757d;
      color: white;
      opacity: 0.6;
    }
    
    /* Estilos para mensajes de error y estado vacío */
    .error-message {
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      padding: 2rem;
      border-radius: 12px;
      text-align: center;
      margin: 1rem 0;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    }
    
    .error-message i {
      font-size: 3em;
      margin-bottom: 1rem;
      display: block;
    }
    
    .error-message h3 {
      margin: 0 0 1rem 0;
      font-size: 1.5em;
    }
    
    .error-message p {
      margin: 0.5rem 0;
      font-size: 1em;
      line-height: 1.4;
    }
    
    .btn-retry {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn-retry:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }
    
    .no-events-message {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      color: #6c757d;
      padding: 3rem 2rem;
      border-radius: 12px;
      text-align: center;
      margin: 1rem 0;
      border: 2px dashed #dee2e6;
    }
    
    .no-events-message i {
      font-size: 4em;
      margin-bottom: 1rem;
      display: block;
      color: #adb5bd;
    }
    
    .no-events-message h3 {
      margin: 0 0 1rem 0;
      font-size: 1.5em;
      color: #495057;
    }
    
    .no-events-message p {
      margin: 0;
      font-size: 1em;
      line-height: 1.4;
      color: #6c757d;
    }
    
    .regalos-status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background: #f8f9fa;
      border-left: 4px solid var(--primary-color);
    }
    
    .regalos-status h4 {
      margin: 0 0 10px 0;
      color: var(--primary-color);
      font-size: 1.1em;
    }
    
    .regalos-status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      padding: 5px 0;
    }
    
    .regalos-status-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .regalos-status-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    /* Estilos para la sección de regalos en efectivo en el resumen */
    .efectivo-status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background: #f8f9fa;
      border-left: 4px solid var(--primary-color);
    }
    
    .efectivo-status h4 {
      margin: 0 0 10px 0;
      color: var(--primary-color);
      font-size: 1.1em;
    }
    
    .efectivo-status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      padding: 5px 0;
    }
    
    .efectivo-status-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .efectivo-status-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    .cash-gift-item {
      background: white;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .cash-gift-amount {
      font-size: 1.2em;
      font-weight: 700;
      color: #28a745;
      margin-bottom: 5px;
    }
    
    .cash-gift-date {
      font-size: 0.9em;
      color: #6c757d;
      margin-bottom: 5px;
    }
    
    .cash-gift-message {
      font-size: 0.9em;
      color: var(--text-color);
      font-style: italic;
      background: #f8f9fa;
      padding: 8px;
      border-radius: 4px;
      margin-top: 8px;
    }
    
    .no-cash-gifts {
      text-align: center;
      padding: 20px;
      color: #6c757d;
      font-style: italic;
    }
    
    .no-cash-gifts i {
      font-size: 2em;
      margin-bottom: 10px;
      color: #adb5bd;
      display: block;
    }
    
    /* Layout principal con columna de comentarios - VERSIÓN SIMPLIFICADA */
    .main-layout {
      display: flex !important;
      flex-direction: row !important;
      width: 100% !important;
      min-height: calc(100vh - 100px) !important;
      margin-top: 40px;
      gap: 20px !important;
      align-items: stretch !important;
      box-sizing: border-box !important;
    }
    

    
    .comments-sidebar {
      flex: 0 0 50% !important;
      width: 50% !important;
      padding: 20px;
      height: 100% !important;
      overflow-y: auto;
      max-width: 50% !important;
    }

    /* Estilo para el textarea de comentarios */
    .comment-input-container textarea {
      border: 3px solid var(--primary-color) !important;
      border-radius: 10px !important;
      padding: 15px;
      font-size: 14px;
      line-height: 1.5;
      resize: vertical;
      transition: all 0.3s ease;
      width: 100%;
      box-sizing: border-box;
    }

    .comment-input-container textarea:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 10px rgba(139, 90, 150, 0.2);
    }

    /* Estilos para el contenedor de acciones de comentarios */
    .comments-sidebar .comment-actions {
      display: flex !important;
      justify-content: space-between !important;
      align-items: center !important;
      padding: 10px 0 !important;
      background: transparent !important;
      margin-top: 0 !important;
      position: relative !important;
    }

    /* Estilos para el contador de caracteres */
    .comments-sidebar .char-count-container {
      display: flex !important;
      align-items: center !important;
    }

    .comments-sidebar .char-count {
      color: var(--text-light) !important;
      font-size: 12px !important;
      font-style: italic !important;
    }

    /* Estilos para el botón de publicar */
    .comments-sidebar .comment-submit-btn {
      background: var(--primary-color) !important;
      color: white !important;
      border: none !important;
      padding: 8px 16px !important;
      border-radius: 6px !important;
      cursor: pointer !important;
      font-weight: 500 !important;
      transition: all 0.3s ease !important;
      display: flex !important;
      align-items: center !important;
      gap: 0.5rem !important;
      font-size: 0.9rem !important;
    }

    .comments-sidebar .comment-submit-btn:hover {
      background: #7a4f85 !important;
      transform: translateY(-1px) !important;
    }
    
    /* Estilos para las pestañas - VERSIÓN SIMPLIFICADA */
    .tabs-container {
      flex: 0 0 50% !important;
      width: 50% !important;
      margin: 0 !important;
      padding: 10px !important;
      display: block !important;
      max-width: 50% !important;
      box-sizing: border-box !important;
      height: 100% !important;
    }

    /* Espaciado para el contenido principal */
    main.main-layout {
      margin-top: 40px;
      display: flex !important;
      max-width: none !important;
      margin: 0 !important;
      padding: 0 !important;
      background: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      z-index: auto !important;
      width: 100% !important;
    }
    
    /* Override específico para main */
    main {
      max-width: none !important;
      margin: 0 !important;
      padding: 0 !important;
      background: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      z-index: auto !important;
      display: flex !important;
      width: 100% !important;
    }
    
    /* Override para body */
    body {
      overflow-x: auto !important;
      max-width: none !important;
    }
    
    .tabs-header {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
      border-bottom: 2px solid var(--accent-color);
      background: var(--white);
      border-radius: 15px 15px 0 0;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .tab-btn {
      flex: 1;
      padding: 20px 30px;
      border: none;
      background: transparent;
      color: var(--text-light);
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
    }
    
    .tab-btn:hover {
      background: var(--accent-color);
      color: var(--primary-color);
    }
    
    .tab-btn.active {
      background: var(--gradient-primary);
      color: var(--white);
      box-shadow: 0 4px 15px rgba(139, 90, 150, 0.3);
    }
    
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--white);
    }
    
    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease-in-out;
    }
    
    .tab-content.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Estilos para el formulario del menú */
    .menu-form {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-color);
      font-size: 1.1em;
    }
    
    .form-group label i {
      margin-right: 8px;
      color: var(--primary-color);
    }
    
    .form-group select,
    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 1em;
      transition: all 0.3s ease;
      background: white;
    }
    
    .form-group select:focus,
    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(139, 90, 150, 0.1);
    }
    
    .submit-btn {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 10px;
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(139, 90, 150, 0.3);
    }
    
    .submit-btn i {
      margin-right: 8px;
    }
    
    .current-selection {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid var(--primary-color);
    }
    
    .current-selection h3 {
      margin: 0 0 15px 0;
      color: var(--primary-color);
      font-size: 1.2em;
    }
    
    .selection-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      padding: 8px 0;
      border-bottom: 1px solid #e9ecef;
    }
    
    .selection-item:last-child {
      border-bottom: none;
    }
    
    .selection-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .selection-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    /* Estilos para la agenda */
    .agenda-content {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .agenda-dia {
      margin-bottom: 30px;
      border: 1px solid #e9ecef;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .dia-titulo {
      background: #f8f9fa;
      padding: 15px 20px;
      margin: 0;
      color: var(--primary-color);
      font-size: 1.3em;
      border-bottom: 1px solid #e9ecef;
    }
    
    .dia-titulo i {
      margin-right: 10px;
    }
    
    .eventos-del-dia {
      padding: 0;
    }
    
    .evento-item {
      display: flex;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid #f1f3f4;
      transition: background-color 0.3s ease;
    }
    
    .evento-item:last-child {
      border-bottom: none;
    }
    
    .evento-item:hover {
      background-color: #f8f9fa;
    }
    
    .evento-info {
      flex: 1;
    }
    
    .evento-titulo {
      font-size: 1.2em;
      font-weight: 600;
      color: var(--text-color);
      margin: 0 0 5px 0;
    }
    
    .evento-descripcion {
      color: #6c757d;
      margin: 0 0 8px 0;
      font-size: 0.95em;
    }
    
    .evento-hora {
      color: var(--primary-color);
      font-weight: 500;
      margin: 0;
    }
    
    .evento-hora i {
      margin-right: 5px;
    }
    
    .evento-acciones {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .btn-confirmar {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .btn-confirmar {
      background: #28a745;
      color: white;
    }
    
    .btn-confirmar:hover {
      background: #218838;
      transform: translateY(-1px);
    }
    
    .btn-cancelar {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #dc3545;
      color: white;
    }
    
    .btn-cancelar:hover {
      background: #c82333;
      transform: translateY(-1px);
    }
    
    .current-confirmations {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid var(--primary-color);
    }
    
    .current-confirmations h3 {
      margin: 0 0 15px 0;
      color: var(--primary-color);
      font-size: 1.2em;
    }
    
    .confirmation-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    
    .confirmation-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e9ecef;
    }
    
    .confirmation-item:last-child {
      border-bottom: none;
    }
    
    .confirmation-label {
      font-weight: 600;
      color: var(--text-color);
    }
    
    .confirmation-value {
      color: var(--primary-color);
      font-style: italic;
    }
    
    /* Estilos para la lista de regalos */
    .regalos-container {
      max-width: 100%;
      margin: 0 auto;
      padding: 10px;
    }
    
    .regalos-header {
      text-align: center;
      margin-bottom: 15px;
      padding: 15px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .regalos-header h1 {
      margin: 0;
      font-size: 1.8em;
      font-weight: 300;
    }
    
    .regalos-header p {
      margin: 5px 0 0 0;
      font-size: 1em;
      opacity: 0.9;
    }
    
    .regalos-content {
      background: white;
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      margin-bottom: 10px;
    }
    
    .regalos-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }
    
    .regalo-card {
      border: 1px solid #e9ecef;
      border-radius: 12px;
      padding: 15px;
      transition: all 0.3s ease;
      background: white;
    }
    
    .regalo-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    
    .regalo-card.reservado-por-mi {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
    }
    
    .regalo-info h4 {
      margin: 0 0 8px 0;
      color: var(--text-color);
      font-size: 1.1em;
      font-weight: 600;
    }
    
    .regalo-info p {
      color: #6c757d;
      margin: 0 0 10px 0;
      line-height: 1.4;
      font-size: 0.9em;
    }
    
    .regalo-enlace {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 600;
      margin-bottom: 10px;
      transition: color 0.3s ease;
      font-size: 0.9em;
    }
    
    .regalo-enlace:hover {
      color: var(--secondary-color);
    }
    
    .regalo-accion {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
    }
    
    .status-available {
      background: #d4edda;
      color: #155724;
    }
    
         .btn-disabled {
       padding: 6px 12px;
       border: none;
       border-radius: 6px;
       font-size: 0.8em;
       font-weight: 600;
       cursor: not-allowed;
       background: #6c757d;
       color: white;
       opacity: 0.6;
     }
     
     /* Estilos para la columna de comentarios */
     .comments-header {
       margin-bottom: 20px;
       padding-bottom: 15px;
       border-bottom: 2px solid var(--accent-color);
     }
     
     .comments-header h3 {
       margin: 0 0 8px 0;
       color: var(--primary-color);
       font-size: 1.3em;
       display: flex;
       align-items: center;
       gap: 8px;
     }
     
     .comments-subtitle {
       margin: 0;
       color: var(--text-light);
       font-size: 0.9em;
       font-style: italic;
     }
     
     .new-comment-form {
       margin-bottom: 25px;
       padding-bottom: 20px;
       border-bottom: 1px solid #e9ecef;
     }
     
     .comment-input-container {
       position: relative;
     }
     
     .comment-input-container textarea {
       width: 100%;
       padding: 12px;
       border: 2px solid #e1e5e9;
       border-radius: 8px;
       font-size: 0.9em;
       font-family: 'Inter', sans-serif;
       resize: vertical;
       min-height: 80px;
       transition: all 0.3s ease;
     }
     
     .comment-input-container textarea:focus {
       outline: none;
       border-color: var(--primary-color);
       box-shadow: 0 0 0 3px rgba(139, 90, 150, 0.1);
     }
     
     .comment-actions {
       display: flex;
       justify-content: space-between;
       align-items: center;
       margin-top: 10px;
     }
     
     .char-count {
       font-size: 0.8em;
       color: var(--text-light);
     }
     
     .comment-submit-btn {
       background: var(--gradient-primary);
       color: white;
       border: none;
       padding: 8px 16px;
       border-radius: 6px;
       font-size: 0.9em;
       font-weight: 600;
       cursor: pointer;
       transition: all 0.3s ease;
       display: flex;
       align-items: center;
       gap: 6px;
     }
     
     .comment-submit-btn:hover {
       transform: translateY(-1px);
       box-shadow: 0 4px 12px rgba(139, 90, 150, 0.3);
     }
     
     .comment-submit-btn:disabled {
       opacity: 0.6;
       cursor: not-allowed;
       transform: none;
     }
     
     .comments-list {
       max-height: calc(100vh - 400px);
       overflow-y: auto;
     }
     
     .loading-comments {
       text-align: center;
       padding: 20px;
       color: var(--text-light);
       font-style: italic;
     }
     
     .loading-comments i {
       margin-right: 8px;
       color: var(--primary-color);
     }
     
     .comment-item {
       background: #f8f9fa;
       border-radius: 8px;
       padding: 15px;
       margin-bottom: 15px;
       border-left: 3px solid var(--primary-color);
       transition: all 0.3s ease;
     }
     
     .comment-item:hover {
       box-shadow: 0 2px 8px rgba(0,0,0,0.1);
     }
     
     .comment-header {
       display: flex;
       justify-content: space-between;
       align-items: flex-start;
       margin-bottom: 8px;
     }
     
     .comment-author {
       font-weight: 600;
       color: var(--primary-color);
       font-size: 0.95em;
     }
     
     .comment-date {
       font-size: 0.8em;
       color: var(--text-light);
     }
     
     .comment-content {
       color: var(--text-dark);
       line-height: 1.4;
       font-size: 0.9em;
       margin-bottom: 8px;
     }
     
     .comment-actions-comment {
       display: flex;
       justify-content: flex-end;
       gap: 8px;
     }
     
     .delete-comment-btn {
       background: none;
       border: none;
       color: #dc3545;
       cursor: pointer;
       padding: 4px 8px;
       border-radius: 4px;
       font-size: 0.8em;
       transition: all 0.3s ease;
       opacity: 0;
     }
     
     .comment-item:hover .delete-comment-btn {
       opacity: 1;
     }
     
     .delete-comment-btn:hover {
       background: rgba(220, 53, 69, 0.1);
     }
     
     .no-comments {
       text-align: center;
       padding: 30px 20px;
       color: var(--text-light);
       font-style: italic;
     }
     
     .no-comments i {
       font-size: 2em;
       margin-bottom: 10px;
       color: var(--accent-color);
     }
     
     /* Responsive para la columna de comentarios */
     @media (max-width: 768px) {
       .main-layout {
         flex-direction: column !important;
         gap: 20px !important;
       }
       
       .main-content {
         flex: 1 1 100% !important;
         width: 100% !important;
         padding-right: 0;
         padding-bottom: 20px;
         order: 1 !important;
       }
       
       .comments-sidebar {
         flex: 1 1 100% !important;
         width: 100% !important;
         height: auto;
         max-height: 400px;
         min-width: auto;
         border-left: none;
         border-top: 1px solid #e9ecef;
         box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
         position: relative;
         order: 2 !important;
       }
       
       .comments-list {
         max-height: 300px;
       }
     }
     
     /* Estilos para toasts */
     .toast {
       position: fixed;
       top: 20px;
       right: 20px;
       background: white;
       border-radius: 8px;
       box-shadow: 0 4px 20px rgba(0,0,0,0.15);
       padding: 15px 20px;
       z-index: 1000;
       transform: translateX(100%);
       transition: transform 0.3s ease;
       max-width: 300px;
     }
     
     .toast.show {
       transform: translateX(0);
     }
     
     .toast-success {
       border-left: 4px solid #28a745;
     }
     
     .toast-error {
       border-left: 4px solid #dc3545;
     }
     
     .toast-content {
       display: flex;
       align-items: center;
       gap: 10px;
     }
     
     .toast-content i {
       font-size: 1.2em;
     }
     
     .toast-success .toast-content i {
       color: #28a745;
     }
     
     .toast-error .toast-content i {
       color: #dc3545;
     }

     /* Estilos para regalos en efectivo */
     .cash-gifts-container {
       background: white;
       border-radius: 15px;
       padding: 30px;
       box-shadow: 0 4px 20px rgba(0,0,0,0.1);
       margin-bottom: 20px;
     }

     .amount-options {
       display: grid;
       grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
       gap: 20px;
       margin-bottom: 30px;
     }

     .amount-option {
       background: white;
       border: 2px solid #e1e5e9;
       border-radius: 12px;
       padding: 20px;
       text-align: center;
       cursor: pointer;
       transition: all 0.3s ease;
       position: relative;
     }

     .amount-option:hover {
       border-color: var(--primary-color);
       transform: translateY(-2px);
       box-shadow: 0 8px 25px rgba(139, 90, 150, 0.15);
     }

     .amount-option.selected {
       border-color: var(--primary-color);
       background: linear-gradient(135deg, rgba(139, 90, 150, 0.1), rgba(212, 165, 165, 0.1));
     }

     .amount-option .amount {
       font-size: 1.8rem;
       font-weight: 700;
       color: var(--primary-color);
       margin-bottom: 5px;
     }

    .amount-option .label {
      font-size: 0.9rem;
      color: var(--text-light);
      font-weight: 500;
    }

    .amount-option .description {
      font-size: 0.8rem;
      color: var(--text-light);
      margin-top: 5px;
      font-style: italic;
    }

    /* Estilos para tarjetas con imagen de fondo */
    .amount-option[style*="background-image"] {
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
      background-color: rgba(0, 0, 0, 0.3) !important;
    }

    .amount-option[style*="background-image"] .amount {
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }

    .amount-option[style*="background-image"] .label {
      color: white;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    }

    .amount-option[style*="background-image"] .description {
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    }


    .donor-info {
      background: white;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      padding: 20px;
    }

    .donor-info input[readonly] {
      background-color: #f8f9fa;
      color: #6c757d;
      cursor: not-allowed;
    }
       margin-bottom: 30px;
     }

     .donor-info h3 {
       color: var(--primary-color);
       margin-bottom: 15px;
       display: flex;
       align-items: center;
       gap: 10px;
     }

     .donor-info .form-group {
       margin-bottom: 20px;
     }

     .donor-info .form-group label {
       display: block;
       margin-bottom: 8px;
       font-weight: 600;
       color: var(--text-color);
     }

     .donor-info .form-group input,
     .donor-info .form-group textarea {
       width: 100%;
       padding: 12px 15px;
       border: 2px solid #e1e5e9;
       border-radius: 8px;
       font-size: 1rem;
       transition: all 0.3s ease;
     }

     .donor-info .form-group input:focus,
     .donor-info .form-group textarea:focus {
       outline: none;
       border-color: var(--primary-color);
       box-shadow: 0 0 0 3px rgba(139, 90, 150, 0.1);
     }

     .donor-info .form-group textarea {
       resize: vertical;
       min-height: 80px;
     }

     .payment-section {
       text-align: center;
       margin-top: 30px;
     }

     .payment-summary {
       background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
       color: white;
       border-radius: 12px;
       padding: 20px;
       margin-bottom: 20px;
     }

     .payment-summary h3 {
       margin: 0 0 10px 0;
       font-size: 1.3rem;
     }

     .payment-summary .amount {
       font-size: 2rem;
       font-weight: 700;
       margin: 0;
     }

     .stripe-button {
       background: linear-gradient(135deg, #635bff, #00d4aa);
       color: white;
       border: none;
       padding: 15px 40px;
       border-radius: 8px;
       font-size: 1.1rem;
       font-weight: 600;
       cursor: pointer;
       transition: all 0.3s ease;
       display: inline-flex;
       align-items: center;
       gap: 10px;
       box-shadow: 0 4px 15px rgba(99, 91, 255, 0.3);
     }

     .stripe-button:hover {
       transform: translateY(-2px);
       box-shadow: 0 8px 25px rgba(99, 91, 255, 0.4);
     }

     .stripe-button:disabled {
       opacity: 0.6;
       cursor: not-allowed;
       transform: none;
     }

     /* Responsive para regalos en efectivo */
     @media (max-width: 768px) {
       .amount-options {
         grid-template-columns: repeat(2, 1fr);
         gap: 15px;
       }

     }

     /* Estilos para el header con selector de idiomas */
     .header-content {
       display: flex;
       justify-content: space-between;
       align-items: flex-start;
       width: 100%;
     }
     
     .header-left {
       flex: 1;
     }
     
     /* Estilos para el selector de idiomas */
     .language-selector {
       position: relative;
       margin-left: 20px;
       z-index: 1000;
     }

     /* Estilos para el icono de acceso al login */
     .login-access-icon {
       margin-left: 15px;
       z-index: 1000;
     }

     .login-access-icon a {
       display: flex;
       align-items: center;
       justify-content: center;
       width: 40px;
       height: 40px;
       background: rgba(255, 255, 255, 0.1);
       border: 1px solid rgba(255, 255, 255, 0.2);
       border-radius: 8px;
       color: white;
       font-size: 18px;
       text-decoration: none;
       transition: all 0.3s ease;
       backdrop-filter: blur(10px);
     }

     .login-access-icon a:hover {
       background: rgba(255, 255, 255, 0.2);
       border-color: rgba(255, 255, 255, 0.3);
       transform: translateY(-1px);
       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
     }

     .login-access-icon a:focus {
       outline: none;
       box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
     }
     
     .language-selector-wrapper {
       position: relative;
     }
     
     .language-selector-dropdown {
       position: relative;
       display: inline-block;
     }
     
     .language-selector-toggle {
       display: flex;
       align-items: center;
       gap: 8px;
       padding: 8px 12px;
       height: 40px;
       background: rgba(255, 255, 255, 0.1);
       border: 1px solid rgba(255, 255, 255, 0.2);
       border-radius: 8px;
       color: white;
       font-size: 14px;
       font-weight: 500;
       cursor: pointer;
       transition: all 0.3s ease;
       backdrop-filter: blur(10px);
       min-width: 120px;
     }
     
     .language-selector-toggle:hover {
       background: rgba(255, 255, 255, 0.2);
       border-color: rgba(255, 255, 255, 0.3);
       transform: translateY(-1px);
       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
     }
     
     .language-selector-menu {
       position: absolute;
       top: 100%;
       right: 0;
       margin-top: 8px;
       background: white;
       border: 1px solid #e1e5e9;
       border-radius: 12px;
       box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
       backdrop-filter: blur(20px);
       min-width: 160px;
       opacity: 0;
       visibility: hidden;
       transform: translateY(-10px);
       transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
       z-index: 1001;
       overflow: hidden;
     }
     
     .language-selector-menu.show {
       opacity: 1;
       visibility: visible;
       transform: translateY(0);
     }
     
     .language-option {
       display: flex;
       align-items: center;
       justify-content: space-between;
       padding: 12px 16px;
       border: none;
       background: none;
       width: 100%;
       text-align: left;
       cursor: pointer;
       transition: all 0.2s ease;
       color: #333;
       font-size: 14px;
       font-weight: 500;
       border-bottom: 1px solid #f5f5f5;
     }
     
     .language-option:last-child {
       border-bottom: none;
     }
     
     .language-option:hover {
       background: #f8f9fa;
       color: #007bff;
     }
     
     .language-option.active {
       background: #e3f2fd;
       color: #1976d2;
       font-weight: 600;
     }
     
     /* Asegurar que el header tenga el espacio correcto */
     header {
       position: relative;
       padding: 20px;
     }
     
     /* Estilos para el contenedor de bienvenida */
     .welcome-container {
       display: flex;
       align-items: center;
       gap: 15px;
       flex-wrap: wrap;
     }
     
     .welcome-container h1 {
       margin: 0;
       flex-shrink: 0;
     }
     
     /* Estilos para el nombre del invitado */
     .guest-name-display {
       padding: 6px 12px;
       background: rgba(255, 255, 255, 0.15);
       border: 1px solid rgba(255, 255, 255, 0.3);
       border-radius: 20px;
       color: white;
       font-size: 1em;
       font-weight: 600;
       backdrop-filter: blur(10px);
       animation: fadeInUp 0.5s ease-out;
       text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
       white-space: nowrap;
     }
     
     @keyframes fadeInUp {
       from {
         opacity: 0;
         transform: translateY(10px);
       }
       to {
         opacity: 1;
         transform: translateY(0);
       }
     }
     
     /* Responsive para el contenedor de bienvenida */
     @media (max-width: 768px) {
       .welcome-container {
         flex-direction: column;
         align-items: flex-start;
         gap: 10px;
       }
       
       .welcome-container h1 {
         font-size: 1.2em;
       }
       
       .guest-name-display {
         font-size: 0.9em;
         padding: 4px 10px;
       }
     }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="header-left">
        <a href="index-i18n-fixed.html" class="home-link">
          <i class="fas fa-home"></i>
          <span data-i18n="common:home">Inicio</span>
        </a>
        <div class="welcome-container">
          <h1 data-i18n="guests:welcomeTitle">Bienvenido a la zona de invitados</h1>
          <span id="guestNameDisplay" class="guest-name-display" style="display: none;"></span>
        </div>
      </div>
      <div class="language-selector">
        <div class="language-selector-wrapper">
          <div class="language-selector-dropdown">
            <button class="language-selector-toggle" id="language-toggle" aria-label="Select language">
              <span class="current-language">
                <span class="flag">🇪🇸</span>
                <span class="name">Español</span>
              </span>
              <i class="fas fa-chevron-down"></i>
            </button>
            <div class="language-selector-menu" id="language-menu">
              <button class="language-option active" data-lang="es">
                <span class="flag">🇪🇸</span>
                <span class="name">Español</span>
              </button>
              <button class="language-option" data-lang="en">
                <span class="flag">🇬🇧</span>
                <span class="name">English</span>
              </button>
              <button class="language-option" data-lang="fr">
                <span class="flag">🇫🇷</span>
                <span class="name">Français</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
      <div class="login-access-icon">
        <a href="login-i18n.html" title="Acceso para invitados" aria-label="Acceso para invitados">
          <i class="fas fa-user"></i>
        </a>
      </div>
    </div>
  </header>
  <main class="main-layout">
    <!-- Sistema de pestañas -->
    <div class="tabs-container">
      <div class="tabs-header">
        <button class="tab-btn active" data-tab="resumen">
          <i class="fas fa-chart-bar"></i>
          <span data-i18n="guests:tabSummary">Resumen</span>
        </button>
        <button class="tab-btn" data-tab="agenda">
          <i class="fas fa-calendar-alt"></i>
          <span data-i18n="guests:tabAgenda">Agenda</span>
        </button>
        <button class="tab-btn" data-tab="menu">
          <i class="fas fa-utensils"></i>
          <span data-i18n="guests:tabMenu">Menú</span>
        </button>
        <button class="tab-btn" data-tab="efectivo">
          <i class="fas fa-money-bill-wave"></i>
          <span data-i18n="guests:tabCash">Regalos</span>
        </button>
      </div>
      
      <!-- Contenido de la pestaña Resumen -->
      <div id="resumen-tab" class="tab-content active">
        <section id="infoAgenda">
          <h2><i class="fas fa-calendar-alt"></i> <span data-i18n="guests:eventAgenda">Agenda de Eventos</span></h2>
          <p class="section-description" data-i18n="guests:eventAgendaDesc">
            Tus confirmaciones de asistencia a los eventos de nuestra boda.
          </p>
          <div id="agendaStatus" class="agenda-status">
            <div id="agendaStatusContent"></div>
          </div>
        </section>

        <section id="infoMenu">
          <h2><i class="fas fa-utensils"></i> <span data-i18n="guests:menuSelection">Selección de Menú</span></h2>
          <p class="section-description" data-i18n="guests:menuSelectionDesc">
            Tu selección actual de menú para nuestra boda.
          </p>
          <div id="menuStatus" class="menu-status">
            <div id="menuStatusContent"></div>
          </div>
        </section>


        <section id="infoEfectivo">
          <h2><i class="fas fa-money-bill-wave"></i> <span data-i18n="guests:cashGifts">Regalos en Efectivo</span></h2>
          <p class="section-description" data-i18n="guests:cashGiftsSummaryDesc">
            Tus regalos en efectivo realizados para nuestra boda.
          </p>
          <div id="efectivoStatus" class="efectivo-status">
            <div id="efectivoStatusContent"></div>
          </div>
        </section>
      </div>
      
      <!-- Contenido de la pestaña Menú -->
      <div id="menu-tab" class="tab-content">
        <section id="infoMenu">
          <h2><i class="fas fa-utensils"></i> <span data-i18n="guests:menuSelection">Selección de Menú</span></h2>
          <p class="section-description" data-i18n="guests:menuSelectionDesc2">
            Elige tus platos preferidos para nuestra boda.
          </p>
          <div id="menuContent"></div>
        </section>
      </div>
      
      <!-- Contenido de la pestaña Agenda -->
      <div id="agenda-tab" class="tab-content">
        <section id="infoAgenda">
          <h2><i class="fas fa-calendar-alt"></i> <span data-i18n="guests:eventAgenda">Agenda de Eventos</span></h2>
          <p class="section-description" data-i18n="guests:eventAgendaDesc2">
            Confirma tu asistencia a cada uno de los eventos de nuestra boda.
          </p>
          <div id="agendaContent"></div>
        </section>
      </div>
      
      
      <!-- Contenido de la pestaña Regalos -->
      <div id="efectivo-tab" class="tab-content">
        <section id="infoEfectivo">
          <h2><i class="fas fa-money-bill-wave"></i> <span data-i18n="guests:cashGifts">Regalos en Efectivo</span></h2>
          <p class="section-description" data-i18n="guests:cashGiftsDesc">
            Si prefieres hacer un regalo en efectivo, puedes elegir una cantidad fija o personalizada. Tu generosidad nos ayudará a comenzar nuestra nueva vida juntos.
          </p>
          <div class="cash-gifts-container">
            <div class="amount-options">
              <!-- Las tarjetas se cargarán dinámicamente desde el servidor -->
            </div>
            
            <div class="payment-section">
              <div class="payment-summary" id="paymentSummary" style="display: none;">
                <h3 data-i18n="guests:paymentSummary">Resumen del Regalo</h3>
                <p class="amount" id="selectedAmount">€0</p>
              </div>
              <button class="stripe-button" id="payButton" disabled>
                <i class="fas fa-credit-card"></i>
                <span data-i18n="guests:proceedPayment">Proceder al Pago</span>
              </button>
            </div>

            <div class="donor-info">
              <h3><i class="fas fa-user"></i> <span data-i18n="guests:donorInfo">Tu Información</span></h3>
              <div class="form-group">
                <label for="donorName" data-i18n="guests:donorName">Nombre completo</label>
                <input type="text" id="donorName" readonly>
              </div>
              <div class="form-group">
                <label for="donorEmail" data-i18n="guests:donorEmail">Email</label>
                <input type="email" id="donorEmail" readonly>
              </div>
              <div class="form-group">
                <label for="donorMessage" data-i18n="guests:donorMessage">Mensaje para los novios (opcional)</label>
                <textarea id="donorMessage" data-i18n-placeholder="guests:messagePlaceholder" placeholder="Escribe un mensaje especial para Iluminada y George..."></textarea>
              </div>
            </div>
          </div>
          <div id="cashGiftsMessage" class="message"></div>
        </section>
      </div>
    </div>
    
    <!-- Columna de comentarios -->
    <div class="comments-sidebar">
      <div class="comments-header">
        <h3><i class="fas fa-comments"></i> <span data-i18n="guests:commentsTitle">Comentarios</span></h3>
        <p class="comments-subtitle" data-i18n="guests:commentsSubtitle">Comparte tus pensamientos con otros invitados</p>
      </div>
      
      <!-- Formulario para nuevo comentario -->
      <div class="new-comment-form">
        <form id="commentForm">
          <div class="comment-input-container">
            <textarea 
              id="newComment" 
              name="comment" 
              placeholder="Escribe tu comentario..." 
              rows="3"
              maxlength="500"
              data-i18n-placeholder="guests:commentPlaceholder"
            ></textarea>
          </div>
          <div class="comment-actions">
            <div class="char-count-container">
              <span class="char-count">0/500</span>
            </div>
            <button type="submit" class="comment-submit-btn">
              <i class="fas fa-paper-plane"></i>
              <span data-i18n="guests:postComment">Publicar</span>
            </button>
          </div>
        </form>
      </div>
      
      <!-- Lista de comentarios -->
      <div class="comments-list" id="commentsList">
        <!-- Los comentarios se cargarán dinámicamente aquí -->
        <div class="loading-comments">
          <i class="fas fa-spinner fa-spin"></i>
          <span data-i18n="guests:loadingComments">Cargando comentarios...</span>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <button onclick="logoutInvitado()" class="logout-btn">
        <i class="fas fa-sign-out-alt"></i>
        <span data-i18n="guests:logout">Cerrar sesión</span>
      </button>
      <button onclick="window.location.href='index-i18n-fixed.html'" class="back-btn">
        <i class="fas fa-home"></i>
        <span data-i18n="guests:backToHome">Volver al inicio</span>
      </button>
    </div>
  </footer>

  <script src="js/i18n-common.js"></script>
  <script src="js/comments.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <script>
    // Datos de traducción para la página de invitados
    const translations = {
      es: {
        'guests:title': 'Zona de invitados - Boda de Iluminada & George',
        'guests:welcomeTitle': 'Bienvenido a la zona de invitados',
        'guests:tabSummary': 'Resumen',
        'guests:tabMenu': 'Menú',
        'guests:tabAgenda': 'Agenda',
        'guests:tabGifts': 'Regalos',
        'guests:menuSelection': 'Selección de Menú',
        'guests:menuSelectionDesc': 'Tu selección actual de menú para nuestra boda.',
        'guests:menuSelectionDesc2': 'Elige tus platos preferidos para nuestra boda.',
        'guests:eventAgenda': 'Agenda de Eventos',
        'guests:eventAgendaDesc': 'Tus confirmaciones de asistencia a los eventos de nuestra boda.',
        'guests:eventAgendaDesc2': 'Confirma tu asistencia a cada uno de los eventos de nuestra boda.',
        'guests:giftList': 'Lista de Regalos',
        'guests:giftListDesc': 'Tus regalos reservados de nuestra lista de deseos.',
        'guests:giftListDesc2': 'Si deseas hacernos un regalo, aquí tienes nuestra lista de deseos. Puedes reservar cualquier regalo que te guste.',
         'guests:logout': 'Cerrar sesión',
         'guests:backToHome': 'Volver al inicio',
         'guests:confirmed': 'Confirmado',
         'guests:pending': 'Pendiente',
         'guests:event': 'Evento',
         'guests:reserved': 'Reservado',
         'guests:currentSelection': 'Tu selección actual',
         'guests:starter': 'Entrante:',
         'guests:mainCourse': 'Plato principal:',
         'guests:dessert': 'Postre:',
         'guests:specialOption': 'Opción especial:',
         'guests:allergies': 'Alergias:',
         'guests:notSelected': 'No seleccionado',
         'guests:selectionStatus': 'Estado de selección',
         'guests:noSelectionYet': 'Aún no has realizado tu selección de menú. Haz clic en el botón de arriba para comenzar.',
         'guests:eventConfirmations': 'Tus confirmaciones de eventos',
         'guests:noEventConfirmations': 'Aún no has confirmado asistencia a ningún evento.',
         'guests:giftReservations': 'Tus regalos reservados',
         'guests:noGiftReservations': 'Aún no has reservado ningún regalo de nuestra lista.',
         'guests:confirmAction': 'Confirmar acción',
         'guests:commentsTitle': 'Comentarios',
         'guests:commentsSubtitle': 'Comparte tus pensamientos con otros invitados',
         'guests:commentPlaceholder': 'Escribe tu comentario...',
         'guests:postComment': 'Publicar',
         'guests:loadingComments': 'Cargando comentarios...',
         'guests:noComments': 'No hay comentarios aún. ¡Sé el primero en comentar!',
         'guests:commentPosted': 'Comentario publicado con éxito',
         'guests:commentDeleted': 'Comentario eliminado con éxito',
         'guests:deleteCommentConfirm': '¿Estás seguro de que quieres eliminar este comentario?',
         'guests:cancel': 'Cancelar',
         'guests:confirm': 'Confirmar',
         'guests:errorLoadingMenu': 'Error al cargar el status del menú:',
         'guests:errorConnection': 'Error de conexión con el servidor.',
         'guests:welcome': 'Bienvenido',
         'guests:welcomePersonalized': 'Bienvenido',
         'guests:menuSaved': 'Menú guardado con éxito',
         'common:home': 'Inicio',
         // Traducciones para regalos en efectivo
         'guests:tabCash': 'Regalos',
         'guests:cashGifts': 'Regalos',
         'guests:cashGiftsDesc': 'Si prefieres hacer un regalo en efectivo, puedes elegir una cantidad fija o personalizada. Tu generosidad nos ayudará a comenzar nuestra nueva vida juntos.',
         'guests:cashGiftsSummaryDesc': 'Tus regalos en efectivo realizados para nuestra boda.',
         'guests:cashGiftsSummary': 'Resumen de Regalos',
         'guests:totalAmount': 'Cantidad total:',
         'guests:giftCount': 'Número de regalos:',
         'guests:lastGift': 'Último regalo:',
         'guests:noCashGifts': 'Aún no has realizado ningún regalo en efectivo.',
         'guests:giftDate': 'Fecha del regalo:',
         'guests:giftMessage': 'Mensaje:',
         'guests:giftHistory': 'Historial de regalos',
         'guests:smallGift': 'Regalo pequeño',
         'guests:mediumGift': 'Regalo medio',
         'guests:generousGift': 'Regalo generoso',
         'guests:specialGift': 'Regalo especial',
         'guests:donorInfo': 'Tu Información',
         'guests:donorName': 'Nombre completo',
         'guests:donorEmail': 'Email',
         'guests:donorMessage': 'Mensaje para los novios (opcional)',
         'guests:messagePlaceholder': 'Escribe un mensaje especial para Iluminada y George...',
         'guests:paymentSummary': 'Resumen del Regalo',
         'guests:proceedPayment': 'Proceder al Pago',
         'guests:selectAmount': 'Por favor, selecciona una cantidad',
         'guests:fillRequired': 'Por favor, completa todos los campos obligatorios',
         'guests:processing': 'Procesando pago...',
         'guests:error': 'Error al procesar el pago',
         // Traducciones para eventos de la agenda
         'events:cocktail': 'Cocktail de Bienvenida',
         'events:ceremony': 'Ceremonia de Boda',
         'events:reception': 'Recepción de Invitados',
         'events:brunch': 'Brunch de Despedida',
         'events:cocktailDesc': 'Celebración informal para dar la bienvenida a todos los invitados',
         'events:ceremonyDesc': 'Ceremonia religiosa de Iluminada y George',
         'events:receptionDesc': 'Celebración principal con cena y baile',
         'events:brunchDesc': 'Desayuno informal para despedir a los invitados'
      },
      en: {
        'guests:title': 'Guest Zone - Iluminada & George Wedding',
        'guests:welcomeTitle': 'Welcome to the guest zone',
        'guests:tabSummary': 'Summary',
        'guests:tabMenu': 'Menu',
        'guests:tabAgenda': 'Agenda',
        'guests:tabGifts': 'Gifts',
        'guests:menuSelection': 'Menu Selection',
        'guests:menuSelectionDesc': 'Your current menu selection for our wedding.',
        'guests:menuSelectionDesc2': 'Choose your preferred dishes for our wedding.',
        'guests:eventAgenda': 'Event Agenda',
        'guests:eventAgendaDesc': 'Your attendance confirmations for our wedding events.',
        'guests:eventAgendaDesc2': 'Confirm your attendance to each of our wedding events.',
        'guests:giftList': 'Gift List',
        'guests:giftListDesc': 'Your reserved gifts from our wish list.',
        'guests:giftListDesc2': 'If you want to give us a gift, here is our wish list. You can reserve any gift you like.',
         'guests:logout': 'Logout',
         'guests:backToHome': 'Back to home',
         'guests:confirmed': 'Confirmed',
         'guests:pending': 'Pending',
         'guests:event': 'Event',
         'guests:reserved': 'Reserved',
         'guests:currentSelection': 'Your current selection',
         'guests:starter': 'Starter:',
         'guests:mainCourse': 'Main course:',
         'guests:dessert': 'Dessert:',
         'guests:specialOption': 'Special option:',
         'guests:allergies': 'Allergies:',
         'guests:notSelected': 'Not selected',
         'guests:selectionStatus': 'Selection status',
         'guests:noSelectionYet': 'You haven\'t made your menu selection yet. Click the button above to start.',
         'guests:eventConfirmations': 'Your event confirmations',
         'guests:noEventConfirmations': 'You haven\'t confirmed attendance to any events yet.',
         'guests:giftReservations': 'Your reserved gifts',
         'guests:noGiftReservations': 'You haven\'t reserved any gifts from our list yet.',
         'guests:confirmAction': 'Confirm action',
         'guests:commentsTitle': 'Comments',
         'guests:commentsSubtitle': 'Share your thoughts with other guests',
         'guests:commentPlaceholder': 'Write your comment...',
         'guests:postComment': 'Post',
         'guests:loadingComments': 'Loading comments...',
         'guests:noComments': 'No comments yet. Be the first to comment!',
         'guests:commentPosted': 'Comment posted successfully',
         'guests:commentDeleted': 'Comment deleted successfully',
         'guests:deleteCommentConfirm': 'Are you sure you want to delete this comment?',
         'guests:cancel': 'Cancel',
         'guests:confirm': 'Confirm',
         'guests:errorLoadingMenu': 'Error loading menu status:',
         'guests:errorConnection': 'Server connection error.',
         'guests:welcome': 'Welcome',
         'guests:welcomePersonalized': 'Welcome',
         'guests:menuSaved': 'Menu saved successfully',
         'common:home': 'Home',
         // Traducciones para regalos en efectivo
         'guests:tabCash': 'Cash Gifts',
         'guests:cashGifts': 'Cash Gifts',
         'guests:cashGiftsDesc': 'If you prefer to give a cash gift, you can choose a fixed or custom amount. Your generosity will help us start our new life together.',
         'guests:cashGiftsSummaryDesc': 'Your cash gifts made for our wedding.',
         'guests:cashGiftsSummary': 'Cash Gifts Summary',
         'guests:totalAmount': 'Total amount:',
         'guests:giftCount': 'Number of gifts:',
         'guests:lastGift': 'Last gift:',
         'guests:noCashGifts': 'You haven\'t made any cash gifts yet.',
         'guests:giftDate': 'Gift date:',
         'guests:giftMessage': 'Message:',
         'guests:giftHistory': 'Gift History',
         'guests:smallGift': 'Small gift',
         'guests:mediumGift': 'Medium gift',
         'guests:generousGift': 'Generous gift',
         'guests:specialGift': 'Special gift',
         'guests:donorInfo': 'Your Information',
         'guests:donorName': 'Full name',
         'guests:donorEmail': 'Email',
         'guests:donorMessage': 'Message for the couple (optional)',
         'guests:messagePlaceholder': 'Write a special message for Iluminada and George...',
         'guests:paymentSummary': 'Gift Summary',
         'guests:proceedPayment': 'Proceed to Payment',
         'guests:selectAmount': 'Please select an amount',
         'guests:fillRequired': 'Please fill in all required fields',
         'guests:processing': 'Processing payment...',
         'guests:error': 'Error processing payment',
         // Traducciones para eventos de la agenda
         'events:cocktail': 'Welcome Cocktail',
         'events:ceremony': 'Wedding Ceremony',
         'events:reception': 'Guest Reception',
         'events:brunch': 'Farewell Brunch',
         'events:cocktailDesc': 'Informal celebration to welcome all guests',
         'events:ceremonyDesc': 'Religious ceremony of Iluminada and George',
         'events:receptionDesc': 'Main celebration with dinner and dancing',
         'events:brunchDesc': 'Informal breakfast to say goodbye to guests'
      },
      fr: {
        'guests:title': 'Zone des Invités - Mariage d\'Iluminada & George',
        'guests:welcomeTitle': 'Bienvenue dans la zone des invités',
        'guests:tabSummary': 'Résumé',
        'guests:tabMenu': 'Menu',
        'guests:tabAgenda': 'Agenda',
        'guests:tabGifts': 'Cadeaux',
        'guests:menuSelection': 'Sélection du Menu',
        'guests:menuSelectionDesc': 'Votre sélection actuelle de menu pour notre mariage.',
        'guests:menuSelectionDesc2': 'Choisissez vos plats préférés pour notre mariage.',
        'guests:eventAgenda': 'Agenda des Événements',
        'guests:eventAgendaDesc': 'Vos confirmations de présence pour les événements de notre mariage.',
        'guests:eventAgendaDesc2': 'Confirmez votre présence à chacun des événements de notre mariage.',
        'guests:giftList': 'Liste de Cadeaux',
        'guests:giftListDesc': 'Vos cadeaux réservés de notre liste de souhaits.',
        'guests:giftListDesc2': 'Si vous souhaitez nous offrir un cadeau, voici notre liste de souhaits. Vous pouvez réserver n\'importe quel cadeau qui vous plaît.',
         'guests:logout': 'Se déconnecter',
         'guests:backToHome': 'Retour à l\'accueil',
         'guests:confirmed': 'Confirmé',
         'guests:pending': 'En attente',
         'guests:event': 'Événement',
         'guests:reserved': 'Réservé',
         'guests:currentSelection': 'Votre sélection actuelle',
         'guests:starter': 'Entrée:',
         'guests:mainCourse': 'Plat principal:',
         'guests:dessert': 'Dessert:',
         'guests:specialOption': 'Option spéciale:',
         'guests:allergies': 'Allergies:',
         'guests:notSelected': 'Non sélectionné',
         'guests:selectionStatus': 'Statut de sélection',
         'guests:noSelectionYet': 'Vous n\'avez pas encore fait votre sélection de menu. Cliquez sur le bouton ci-dessus pour commencer.',
         'guests:eventConfirmations': 'Vos confirmations d\'événements',
         'guests:noEventConfirmations': 'Vous n\'avez pas encore confirmé votre présence à aucun événement.',
         'guests:giftReservations': 'Vos cadeaux réservés',
         'guests:noGiftReservations': 'Vous n\'avez pas encore réservé de cadeaux de notre liste.',
         'guests:confirmAction': 'Confirmer l\'action',
         'guests:commentsTitle': 'Commentaires',
         'guests:commentsSubtitle': 'Partagez vos pensées avec d\'autres invités',
         'guests:commentPlaceholder': 'Écrivez votre commentaire...',
         'guests:postComment': 'Publier',
         'guests:loadingComments': 'Chargement des commentaires...',
         'guests:noComments': 'Aucun commentaire pour le moment. Soyez le premier à commenter !',
         'guests:commentPosted': 'Commentaire publié avec succès',
         'guests:commentDeleted': 'Commentaire supprimé avec succès',
         'guests:deleteCommentConfirm': 'Êtes-vous sûr de vouloir supprimer ce commentaire ?',
         'guests:cancel': 'Annuler',
         'guests:confirm': 'Confirmer',
         'guests:errorLoadingMenu': 'Erreur lors du chargement du statut du menu:',
         'guests:errorConnection': 'Erreur de connexion au serveur.',
         'guests:welcome': 'Bienvenue',
         'guests:welcomePersonalized': 'Bienvenue',
         'guests:menuSaved': 'Menu enregistré avec succès',
         'common:home': 'Accueil',
         // Traducciones para regalos en efectivo
         'guests:tabCash': 'Cadeaux en Espèces',
         'guests:cashGifts': 'Cadeaux en Espèces',
         'guests:cashGiftsDesc': 'Si vous préférez faire un cadeau en espèces, vous pouvez choisir un montant fixe ou personnalisé. Votre générosité nous aidera à commencer notre nouvelle vie ensemble.',
         'guests:cashGiftsSummaryDesc': 'Vos cadeaux en espèces faits pour notre mariage.',
         'guests:cashGiftsSummary': 'Résumé des Cadeaux en Espèces',
         'guests:totalAmount': 'Montant total:',
         'guests:giftCount': 'Nombre de cadeaux:',
         'guests:lastGift': 'Dernier cadeau:',
         'guests:noCashGifts': 'Vous n\'avez pas encore fait de cadeaux en espèces.',
         'guests:giftDate': 'Date du cadeau:',
         'guests:giftMessage': 'Message:',
         'guests:giftHistory': 'Historique des cadeaux',
         'guests:smallGift': 'Petit cadeau',
         'guests:mediumGift': 'Cadeau moyen',
         'guests:generousGift': 'Cadeau généreux',
         'guests:specialGift': 'Cadeau spécial',
         'guests:donorInfo': 'Vos Informations',
         'guests:donorName': 'Nom complet',
         'guests:donorEmail': 'Email',
         'guests:donorMessage': 'Message pour les mariés (optionnel)',
         'guests:messagePlaceholder': 'Écrivez un message spécial pour Iluminada et George...',
         'guests:paymentSummary': 'Résumé du Cadeau',
         'guests:proceedPayment': 'Procéder au Paiement',
         'guests:selectAmount': 'Veuillez sélectionner un montant',
         'guests:fillRequired': 'Veuillez remplir tous les champs obligatoires',
         'guests:processing': 'Traitement du paiement...',
         'guests:error': 'Erreur lors du traitement du paiement',
         // Traducciones para eventos de la agenda
         'events:cocktail': 'Cocktail de Bienvenue',
         'events:ceremony': 'Cérémonie de Mariage',
         'events:reception': 'Réception des Invités',
         'events:brunch': 'Brunch d\'Adieu',
         'events:cocktailDesc': 'Célébration informelle pour souhaiter la bienvenue à tous les invités',
         'events:ceremonyDesc': 'Cérémonie religieuse d\'Iluminada et George',
         'events:receptionDesc': 'Célébration principale avec dîner et danse',
         'events:brunchDesc': 'Petit-déjeuner informel pour dire au revoir aux invités'
      },

    };

    // Hacer las traducciones disponibles globalmente
    window.currentTranslations = translations;

    // Inicializar el sistema i18n
    document.addEventListener('DOMContentLoaded', () => {
      const i18n = initI18n(translations);
      
      // Mostrar nombre del invitado si está logueado
      showGuestName();
      
      // Escuchar cambios de idioma para actualizar el mensaje de bienvenida
      window.addEventListener('languageChanged', () => {
        updateGuestWelcome();
      });
    });
    
    // Función para mostrar el nombre del invitado
    function showGuestName() {
      const guestName = localStorage.getItem('nombre');
      const guestEmail = localStorage.getItem('email');
      
      if (guestName && guestEmail) {
        const guestNameDisplay = document.getElementById('guestNameDisplay');
        
        if (guestNameDisplay) {
          guestNameDisplay.textContent = guestName;
          guestNameDisplay.style.display = 'inline-block';
        }
      }
    }
    
    // Función para actualizar el mensaje de bienvenida cuando cambie el idioma
    function updateGuestWelcome() {
      // Esta función ya no es necesaria ya que el título se mantiene igual
      // Solo actualizamos el nombre si es necesario
      showGuestName();
    }
    
    // Función para activar modo administrador (solo para desarrollo)
    window.enableAdminMode = () => {
      localStorage.setItem('isAdmin', 'true');
      if (window.commentsSystem) {
        window.commentsSystem.updateAdminStatus(true);
      }
      alert('Modo administrador activado. Ahora puedes eliminar comentarios.');
    };
    
    // Función para desactivar modo administrador
    window.disableAdminMode = () => {
      localStorage.setItem('isAdmin', 'false');
      if (window.commentsSystem) {
        window.commentsSystem.updateAdminStatus(false);
      }
      alert('Modo administrador desactivado.');
    };

    // Funcionalidad para regalos en efectivo
    let selectedAmount = 0;
    let selectedOption = null;
    const stripe = Stripe('pk_test_51S3mEM1VZvSGk6xq2xUlkklkqrZtPH8zSPbZJRAARzmLLyDUBvCzjp1iEzn3xBYpEvgIGDHSgDd4McnqokupordX00JH8BtacP');

    function selectAmount(amount, element) {
      selectedAmount = amount;
      selectedOption = element;
      
      // Remover selección anterior
      document.querySelectorAll('.amount-option').forEach(option => {
        option.classList.remove('selected');
      });
      
      // Agregar selección actual
      if (element) {
        element.classList.add('selected');
      }
      
      
      updatePaymentSummary();
      checkFormValidity();
    }


    function updatePaymentSummary() {
      const summary = document.getElementById('paymentSummary');
      const amountDisplay = document.getElementById('selectedAmount');
      
      if (selectedAmount > 0) {
        summary.style.display = 'block';
        amountDisplay.textContent = `€${selectedAmount}`;
      } else {
        summary.style.display = 'none';
      }
    }

    function checkFormValidity() {
      const name = document.getElementById('donorName').value.trim();
      const email = document.getElementById('donorEmail').value.trim();
      const payButton = document.getElementById('payButton');
      
      // Los campos de nombre y email se llenan automáticamente, solo necesitamos verificar que hay una cantidad seleccionada
      if (selectedAmount > 0 && name && email) {
        payButton.disabled = false;
      } else {
        payButton.disabled = true;
      }
    }

    function showMessage(message, type = 'info') {
      const container = document.getElementById('cashGiftsMessage');
      container.innerHTML = `<div class="message ${type}">${message}</div>`;
      
      // Auto-ocultar después de 5 segundos
      setTimeout(() => {
        container.innerHTML = '';
      }, 5000);
    }

    async function processPayment() {
      if (!selectedAmount || selectedAmount <= 0) {
        showMessage(translate('guests:selectAmount'), 'error');
        return;
      }

      const name = document.getElementById('donorName').value.trim();
      const email = document.getElementById('donorEmail').value.trim();
      const message = document.getElementById('donorMessage').value.trim();

      // Los campos de nombre y email se llenan automáticamente, pero verificamos que estén presentes
      if (!name || !email) {
        showMessage('Error: No se encontraron los datos del invitado. Por favor, recarga la página.', 'error');
        return;
      }

      const payButton = document.getElementById('payButton');
      payButton.disabled = true;
      payButton.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${translate('guests:processing')}`;

      try {
        // Crear sesión de pago en el backend
        const response = await fetch('/api/create-payment-session', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            amount: Math.round(selectedAmount * 100), // Convertir a centavos
            currency: 'eur',
            donorName: name,
            donorEmail: email,
            donorMessage: message,
            successUrl: `${window.location.origin}/invitados-i18n.html?success=true`,
            cancelUrl: `${window.location.origin}/invitados-i18n.html?canceled=true`
          })
        });

        const session = await response.json();

        if (session.error) {
          throw new Error(session.error);
        }

        // Redirigir a Stripe Checkout
        const { error } = await stripe.redirectToCheckout({
          sessionId: session.id
        });

        if (error) {
          throw new Error(error.message);
        }

      } catch (error) {
        console.error('Error:', error);
        showMessage(translate('guests:error') + ': ' + error.message, 'error');
        
        // Restaurar botón
        payButton.disabled = false;
        payButton.innerHTML = `<i class="fas fa-credit-card"></i> ${translate('guests:proceedPayment')}`;
      }
    }

    // Función para cargar tarjetas de pago del servidor
    async function loadCashGiftCards() {
      try {
        // Llenar automáticamente los datos del invitado autenticado
        const guestName = localStorage.getItem('nombre');
        const guestEmail = localStorage.getItem('email');
        
        if (guestName && guestEmail) {
          const donorNameInput = document.getElementById('donorName');
          const donorEmailInput = document.getElementById('donorEmail');
          
          if (donorNameInput) donorNameInput.value = guestName;
          if (donorEmailInput) donorEmailInput.value = guestEmail;
        }
        
        // Agregar timestamp para evitar cache
        const response = await fetch(`/api/cash-gift-cards?_t=${Date.now()}`);
        const cards = await response.json();
        
        console.log('💳 Tarjetas cargadas:', cards);
        
        const amountOptionsContainer = document.querySelector('.amount-options');
        if (amountOptionsContainer) {
          // Limpiar opciones existentes
          amountOptionsContainer.innerHTML = '';
          
          // Agregar todas las tarjetas del servidor (incluyendo las por defecto)
          cards.forEach(card => {
            const cardElement = document.createElement('div');
            cardElement.className = 'amount-option';
            cardElement.dataset.amount = card.amount;
            
            // Si la tarjeta tiene imagen de fondo, aplicarla
            const backgroundStyle = card.imageUrl ? 
              `background-image: url('${card.imageUrl}'); background-size: cover; background-position: center; background-blend-mode: overlay;` : '';
            
            console.log(`🎨 Aplicando estilo a tarjeta ${card.label}:`, backgroundStyle);
            cardElement.style.cssText = backgroundStyle;
            
            cardElement.innerHTML = `
              <div class="amount">€${card.amount}</div>
              <div class="label">${card.label}</div>
            `;
            
            // Agregar descripción si existe
            if (card.description) {
              const descElement = document.createElement('div');
              descElement.className = 'description';
              descElement.style.cssText = 'font-size: 0.8em; color: #6c757d; margin-top: 5px;';
              descElement.textContent = card.description;
              cardElement.appendChild(descElement);
            }
            
            amountOptionsContainer.appendChild(cardElement);
          });
          
          // Agregar event listeners a las nuevas opciones
          document.querySelectorAll('.amount-option').forEach(option => {
            option.addEventListener('click', () => {
              const amount = parseFloat(option.dataset.amount);
              selectAmount(amount, option);
            });
          });
        }
      } catch (error) {
        console.error('Error loading cash gift cards:', error);
        // En caso de error, mostrar mensaje de error
        const amountOptionsContainer = document.querySelector('.amount-options');
        if (amountOptionsContainer) {
          amountOptionsContainer.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #6c757d;">
              <i class="fas fa-exclamation-triangle" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
              <h4>Error al cargar las tarjetas de pago</h4>
              <p>Por favor, recarga la página o contacta con el administrador.</p>
            </div>
          `;
        }
      }
    }

    // Función para recargar tarjetas cuando se cambie a la pestaña de efectivo
    function reloadCashGiftCards() {
      const efectivoTab = document.querySelector('[data-tab="efectivo"]');
      if (efectivoTab) {
        efectivoTab.addEventListener('click', () => {
          // Recargar tarjetas cuando se haga clic en la pestaña de efectivo
          setTimeout(() => {
            loadCashGiftCards();
          }, 100);
        });
      }
    }

    // Inicializar funcionalidad de regalos en efectivo cuando se carga la página
    document.addEventListener('DOMContentLoaded', () => {
      // Cargar tarjetas de pago del servidor
      loadCashGiftCards();
      
      // Configurar recarga automática en la pestaña de efectivo
      reloadCashGiftCards();


      // Validación de formulario
      const donorNameInput = document.getElementById('donorName');
      const donorEmailInput = document.getElementById('donorEmail');
      if (donorNameInput) donorNameInput.addEventListener('input', checkFormValidity);
      if (donorEmailInput) donorEmailInput.addEventListener('input', checkFormValidity);

      // Botón de pago
      const payButton = document.getElementById('payButton');
      if (payButton) {
        payButton.addEventListener('click', processPayment);
      }

      // Manejar parámetros de URL
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('success') === 'true') {
        showMessage('¡Gracias por tu generoso regalo! Los novios estarán muy agradecidos.', 'success');
      } else if (urlParams.get('canceled') === 'true') {
        showMessage('El pago fue cancelado. Puedes intentar nuevamente cuando quieras.', 'info');
      }
    });
  </script>
  <script src="js/invitados-i18n.js"></script>
</body>
</html>

